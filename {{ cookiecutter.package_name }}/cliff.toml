# cliff.toml
# Git-Cliff config for hybrid changelog system

[git]
conventional_commits = true
filter_unconventional = false
include_commits = "all"

commit_parsers = [
    { message = "^feat", group = "ğŸš€ Added", type = "feat" },
    { message = "^fix", group = "ğŸ› Fixed", type = "fix" },
    { message = "^doc", group = "ğŸ“š Documentation", type = "docs" },
    { message = "^perf", group = "âš¡ Performance", type = "perf" },
    { message = "^refactor", group = "ğŸšœ Refactoring", type = "refactor" },
    { message = "^style", group = "ğŸ¨ Styling", type = "style" },
    { message = "^test", group = "ğŸ§ª Tests", type = "test" },
    { message = "^deprecate", group = "âš ï¸ Deprecated", type = "deprecate" },
    # Assuming 'remove' is an intended type for removed features/files
    { message = "^remove", group = "ğŸš« Removed", type = "remove" }, 
    { message = "^security", group = "ğŸ”’ Security", type = "security" },
    { message = "^chore|^ci", group = "âš™ï¸ Miscellaneous", type = "chore" },
    # Catch-all for anything missed by the above rules
    { message = ".*", group = "âš™ï¸ Miscellaneous", type = "chore" },
]

exclude = [
    "^Merge",
    "^chore: bump version",
    "^chore: update changelog",
    "^docs: update readme",
]

[sections]
"ğŸš€ Added" = ["feat"]
"ğŸ› Fixed" = ["fix"]
"ğŸ“š Documentation" = ["docs"]
"âš¡ Performance" = ["perf"]
"ğŸšœ Refactoring" = ["refactor"]
"ğŸ¨ Styling" = ["style"]
"ğŸ§ª Tests" = ["test"]
"âš ï¸ Deprecated" = ["deprecate"]
"ğŸš« Removed" = ["remove"]
"ğŸ”’ Security" = ["security"]
"ğŸ‘· CI" = ["ci"]
"ğŸ”¨ Build System" = ["build"]
"âš™ï¸ Miscellaneous" = ["chore"]

{% raw %}
[changelog]
# Do NOT auto-write a file â€” we manually direct output
header = ""
footer = ""
body = """ 
---
version: "{{ version }}"
release_date: "{{ date }}"
changes:
{{#each groups}}
  {{ title }}:
  {{#each commits}}
    - message: "{{ message }}"
      scope: "{{ scope }}"
      breaking: {{ breaking }}
  {{/each}}
{{/each}}
"""

# [[changelog.templates]]
# name = "index_append"
# content = """
#  "{{ version }}":
#    file: "releases/{{ version }}.yml"
#    date: "{{ date }}"
# """

{% endraw %}
